diff -Nur MPlayer-1.0rc2-orig/\ MPlayer-1.0rc2/\
--- MPlayer-1.0rc2-orig/\	1969-12-31 19:00:00.000000000 -0500
+++ MPlayer-1.0rc2/\	2010-07-21 16:09:13.825710253 -0400
@@ -0,0 +1,101 @@
+#
+# common bits used by all libraries
+#
+
+VPATH = $(SRC_PATH_BARE)/lib$(NAME)
+SRC_DIR = "$(VPATH)"
+
+CFLAGS   += $(CFLAGS-yes)
+OBJS     += $(OBJS-yes)
+ASM_OBJS += $(ASM_OBJS-yes)
+CPP_OBJS += $(CPP_OBJS-yes)
+
+CFLAGS += -DHAVE_AV_CONFIG_H \
+          -D_ISOC9X_SOURCE -I$(BUILD_ROOT) -I$(SRC_PATH) \
+          -I$(SRC_PATH)/libavutil $(OPTFLAGS)
+
+SRCS := $(OBJS:.o=.c) $(ASM_OBJS:.o=.S) $(CPPOBJS:.o=.cpp)
+OBJS := $(OBJS) $(ASM_OBJS) $(CPPOBJS)
+STATIC_OBJS := $(OBJS) $(STATIC_OBJS)
+SHARED_OBJS := $(OBJS) $(SHARED_OBJS)
+
+all: $(EXTRADEPS) $(LIB) $(SLIBNAME)
+
+$(LIB): $(STATIC_OBJS)
+	rm -f $@
+	$(AR) rc $@ $^ $(EXTRAOBJS)
+	$(RANLIB) $@
+
+$(SLIBNAME): $(SLIBNAME_WITH_MAJOR)
+	ln -sf $^ $@
+
+$(SLIBNAME_WITH_MAJOR): $(SHARED_OBJS)
+	$(CC) $(SHFLAGS) $(LDFLAGS) -o $@ $^ $(EXTRALIBS) $(EXTRAOBJS)
+	$(SLIB_EXTRA_CMD)
+
+%.o: %.c
+	$(CC) $(CFLAGS) $(LIBOBJFLAGS) -c -o $@ $<
+
+%.o: %.S
+	$(CC) $(CFLAGS) $(LIBOBJFLAGS) -c -o $@ $<
+
+%: %.o $(LIB)
+	$(CC) $(LDFLAGS) -o $@ $^ $(EXTRALIBS)
+
+depend dep: $(SRCS)
+	$(CC) -MM $(CFLAGS) $^ 1>.depend
+
+clean::
+	rm -f *.o *~ *.a *.lib *.so *.so.* *.dylib *.dll \
+	      *.def *.dll.a *.exp
+
+distclean: clean
+	rm -f .depend
+
+ifeq ($(BUILD_SHARED),yes)
+INSTLIBTARGETS += install-lib-shared
+endif
+ifeq ($(BUILD_STATIC),yes)
+INSTLIBTARGETS += install-lib-static
+endif
+
+install: install-libs install-headers
+
+install-libs: $(INSTLIBTARGETS)
+
+install-lib-shared: $(SLIBNAME)
+	install -d "$(shlibdir)"
+	install -m 755 $(SLIBNAME) "$(shlibdir)/$(SLIBNAME_WITH_VERSION)"
+	$(STRIP) "$(shlibdir)/$(SLIBNAME_WITH_VERSION)"
+	cd "$(shlibdir)" && \
+		ln -sf $(SLIBNAME_WITH_VERSION) $(SLIBNAME_WITH_MAJOR)
+	cd "$(shlibdir)" && \
+		ln -sf $(SLIBNAME_WITH_VERSION) $(SLIBNAME)
+	$(SLIB_INSTALL_EXTRA_CMD)
+
+install-lib-static: $(LIB)
+	install -d "$(libdir)"
+	install -m 644 $(LIB) "$(libdir)"
+	$(LIB_INSTALL_EXTRA_CMD)
+
+install-headers:
+	install -d "$(incdir)"
+	install -d "$(libdir)/pkgconfig"
+	install -m 644 $(addprefix $(SRC_DIR)/,$(HEADERS)) "$(incdir)"
+	install -m 644 $(BUILD_ROOT)/lib$(NAME).pc "$(libdir)/pkgconfig"
+
+uninstall: uninstall-libs uninstall-headers
+
+uninstall-libs:
+	-rm -f "$(shlibdir)/$(SLIBNAME_WITH_MAJOR)" \
+	       "$(shlibdir)/$(SLIBNAME)"            \
+	       "$(shlibdir)/$(SLIBNAME_WITH_VERSION)"
+	-rm -f "$(libdir)/$(LIB)"
+
+uninstall-headers::
+	rm -f $(addprefix "$(incdir)/",$(HEADERS))
+	rm -f "$(libdir)/pkgconfig/lib$(NAME).pc"
+
+.PHONY: all depend dep clean distclean install* uninstall*
+
+-include .depend
diff -Nur MPlayer-1.0rc2-orig/common.mak MPlayer-1.0rc2/common.mak
--- MPlayer-1.0rc2-orig/common.mak	2010-07-21 16:09:02.485709959 -0400
+++ MPlayer-1.0rc2/common.mak	2010-07-21 16:09:13.825710253 -0400
@@ -10,7 +10,7 @@
 ASM_OBJS += $(ASM_OBJS-yes)
 CPP_OBJS += $(CPP_OBJS-yes)
 
-CFLAGS += -DHAVE_AV_CONFIG_H -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE \
+CFLAGS += -DHAVE_AV_CONFIG_H \
           -D_ISOC9X_SOURCE -I$(BUILD_ROOT) -I$(SRC_PATH) \
           -I$(SRC_PATH)/libavutil $(OPTFLAGS)
 
diff -Nur MPlayer-1.0rc2-orig/configure MPlayer-1.0rc2/configure
--- MPlayer-1.0rc2-orig/configure	2010-07-21 16:09:02.697711272 -0400
+++ MPlayer-1.0rc2/configure	2010-07-21 16:09:13.825710253 -0400
@@ -2331,7 +2331,7 @@
   elif test "$cc_vendor" != "gnu" ; then
     CFLAGS="-O2 $_march $_mcpu $_pipe"
   else
-    CFLAGS="-Wall -Wno-switch -Wpointer-arith -Wredundant-decls -O4 $_march $_mcpu $_pipe -ffast-math -fomit-frame-pointer"
+    CFLAGS="-Wall -Wno-switch -Wpointer-arith -Wredundant-decls -O4 $_march $_mcpu $_pipe -ffast-math -fomit-frame-pointer -fno-stack-protector"
   fi
 else
   _warn_CFLAGS=yes
@@ -5343,16 +5343,10 @@
 
 
 echocheck "VCD support"
-if linux || bsdos || freebsd || netbsd || sunos || darwin || mingw32; then
-  _inputmodules="vcd $_inputmodules"
-  _def_vcd='#define HAVE_VCD 1'
-  _vcd="yes"
-else
-  _def_vcd='#undef HAVE_VCD'
-  _noinputmodules="vcd $_noinputmodules"
-  _res_comment="not supported on this OS"
-  _vcd="no"
-fi
+_def_vcd='#undef HAVE_VCD'
+_noinputmodules="vcd $_noinputmodules"
+_res_comment="not supported on this OS"
+_vcd="no"
 echores "$_vcd"
 
 
@@ -7521,6 +7515,7 @@
 cat > config.mak << EOF
 # -------- Generated by configure -----------
 
+GCC_HOME:= /usr/lib/gcc/\$(shell gcc -dumpmachine)/\$(shell gcc -dumpversion)
 LANG = C
 MAN_LANG = $MAN_LANG
 TARGET_OS = $system_name
@@ -7540,7 +7535,7 @@
 RANLIB = $_ranlib
 LDCONFIG = $_ldconfig
 INSTALL = $_install
-EXTRA_INC = $_inc_extra
+EXTRA_INC = -D__NEXUS__ -mno-mmx -mno-sse -fno-stack-protector -ffast-math -nostdinc -I ../../../../common/include -I ../../../include -I ../../../../../common/include -I ../../../../include -isystem \$(GCC_HOME)/include -isystem \$(GCC_HOME)/include-fixed $_inc_extra
 EXTRAXX_INC = $_inc_extra $_inc_extraxx
 OPTFLAGS = $CFLAGS \$(EXTRA_INC)
 CXXFLAGS = $CXXFLAGS \$(EXTRAXX_INC)
diff -Nur MPlayer-1.0rc2-orig/configure.nexus MPlayer-1.0rc2/configure.nexus
--- MPlayer-1.0rc2-orig/configure.nexus	1969-12-31 19:00:00.000000000 -0500
+++ MPlayer-1.0rc2/configure.nexus	2010-07-21 16:09:13.825710253 -0400
@@ -0,0 +1,70 @@
+#!/bin/bash
+
+# location of build root as seen from the sub(!)directories
+export NEXUSDIR=../../../../..
+LIBDIR=${NEXUSDIR}/user/lib
+
+echo "Calling ./configure with nexus specific settings"
+echo "using $NEXUSDIR as nexus basis"
+./configure --libdir=${LIBDIR} \
+	    --win32codecsdir=${LIBDIR} \
+	    --xanimcodecsdir=${LIBDIR} \
+	    --realcodecsdir=${LIBDIR} \
+	    --disable-vidix-internal \
+	    --disable-vidix-external \
+	    --disable-network \
+	    --disable-inet6 \
+	    --disable-live \
+	    --disable-xmms \
+	    --disable-gethostbyname2 \
+	    --disable-tv \
+	    --disable-pvr \
+	    --disable-rtc \
+	    --disable-smb \
+	    --disable-xvmc \
+	    --disable-gl \
+	    --disable-xv \
+	    --disable-xvmc \
+	    --disable-ivtv \
+	    --disable-xinerama \
+	    --disable-x11 \
+	    --disable-dvb \
+	    --disable-dvbhead \
+	    --disable-iconv \
+	    --disable-v4l2 \
+	    --disable-real \
+	    --disable-xanim \
+	    --disable-fbdev \
+	    --disable-libavutil_so \
+	    --disable-libavcodec_so  \
+	    --disable-libavformat_so  \
+	    --disable-libpostproc_so \
+  	    --disable-dvdnav       \
+  	    --disable-dvdread      \
+  	    --disable-dvdread-internal  \
+  	    --disable-libdvdcss-internal \
+	    --disable-vstream \
+	    --disable-win32dll \
+	    --disable-pthreads \
+	    --disable-termios \
+	    --disable-termcap \
+	    --disable-gui \
+	    --disable-langinfo \
+	    --disable-vm \
+	    --disable-radio \
+	    --disable-freetype \
+	    --disable-fontconfig \
+	    --disable-gethostbyname2 \
+	    --disable-sighandler \
+	    --disable-menu \
+	    --disable-bitmap-font \
+	    --disable-runtime-cpudetection \
+	    --disable-mmx \
+	    --disable-sse --disable-largefiles
+
+# NB: disabled SSE because the CPU check causes an INT7 (processor feature not 
+# supported) on VMWare. We're supposed to send a SIGILL, but cannot.
+
+# XXX : don't try to use disable-fastmemcpy. uClibC only seems to support the
+#       fast inline versions of sincos and sincosf
+
diff -Nur MPlayer-1.0rc2-orig/cpudetect.c MPlayer-1.0rc2/cpudetect.c
--- MPlayer-1.0rc2-orig/cpudetect.c	2010-07-21 16:09:02.441709663 -0400
+++ MPlayer-1.0rc2/cpudetect.c	2010-07-21 16:09:13.830709493 -0400
@@ -334,6 +334,10 @@
 
 static void check_os_katmai_support( void )
 {
+   // nexus does not call SIGILL on an INT7, so testing for SSE is unsafe
+   gCpuCaps.hasSSE=0;
+   return;
+
 #ifdef ARCH_X86_64
    gCpuCaps.hasSSE=1;
    gCpuCaps.hasSSE2=1;
diff -Nur MPlayer-1.0rc2-orig/libao2/ao_oss.c MPlayer-1.0rc2/libao2/ao_oss.c
--- MPlayer-1.0rc2-orig/libao2/ao_oss.c	2010-07-21 16:09:02.713709959 -0400
+++ MPlayer-1.0rc2/libao2/ao_oss.c	2010-07-21 16:09:13.830709493 -0400
@@ -503,6 +503,9 @@
     if(len==0)
         return len;
     if(len>ao_data.outburst || !(flags & AOPLAY_FINAL_CHUNK)) {
+	// apparently this can happen on Nexus
+        if(!ao_data.outburst)
+	    return 0;
         len/=ao_data.outburst;
         len*=ao_data.outburst;
     }
diff -Nur MPlayer-1.0rc2-orig/libvo/Makefile MPlayer-1.0rc2/libvo/Makefile
--- MPlayer-1.0rc2-orig/libvo/Makefile	2010-07-21 16:09:02.481710567 -0400
+++ MPlayer-1.0rc2/libvo/Makefile	2010-07-21 16:09:13.830709493 -0400
@@ -9,6 +9,7 @@
                video_out.c \
                vo_mpegpes.c \
                vo_null.c \
+               vo_nexus.c \
                vo_yuv4mpeg.c \
                $(VO_SRCS) \
 
diff -Nur MPlayer-1.0rc2-orig/libvo/video_out.c MPlayer-1.0rc2/libvo/video_out.c
--- MPlayer-1.0rc2-orig/libvo/video_out.c	2010-07-21 16:09:02.485709959 -0400
+++ MPlayer-1.0rc2/libvo/video_out.c	2010-07-21 16:09:13.830709493 -0400
@@ -66,6 +66,7 @@
 //
 // Externally visible list of all vo drivers
 //
+extern vo_functions_t video_out_nexus;
 extern vo_functions_t video_out_mga;
 extern vo_functions_t video_out_xmga;
 extern vo_functions_t video_out_x11;
@@ -149,6 +150,7 @@
 
 vo_functions_t* video_out_drivers[] =
 {
+        &video_out_nexus,
 #ifdef HAVE_XVR100
         &video_out_xvr100,
 #endif
diff -Nur MPlayer-1.0rc2-orig/libvo/vo_md5sum.c MPlayer-1.0rc2/libvo/vo_md5sum.c
--- MPlayer-1.0rc2-orig/libvo/vo_md5sum.c	2010-07-21 16:09:02.485709959 -0400
+++ MPlayer-1.0rc2/libvo/vo_md5sum.c	2010-07-21 16:09:13.830709493 -0400
@@ -155,7 +155,6 @@
                 info.short_name, MSGTR_VO_GenericError, strerror(errno) );
         exit_player(MSGTR_Exit_error);
     }
-
     return 0;
 }
 
diff -Nur MPlayer-1.0rc2-orig/libvo/vo_nexus.c MPlayer-1.0rc2/libvo/vo_nexus.c
--- MPlayer-1.0rc2-orig/libvo/vo_nexus.c	1969-12-31 19:00:00.000000000 -0500
+++ MPlayer-1.0rc2/libvo/vo_nexus.c	2010-07-21 16:09:13.830709493 -0400
@@ -0,0 +1,89 @@
+/* 
+ * vo_nexus.c, Nexus Blit Renderer for MPlayer
+ *
+ * adapted from vo_png.c
+ */
+
+#include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
+#include <errno.h>
+
+#include "mp_msg.h"
+#include "config.h"
+#include "mp_msg.h"
+#include "help_mp.h"
+#include "video_out.h"
+#include "video_out_internal.h"
+#include "subopt-helper.h"
+
+static vo_info_t info = 
+{
+	"Nexus Framebuffer",
+	"nexus",
+	"Willem de Bruijn <wdb@cs.cornell.edu>",
+	""
+};
+
+LIBVO_EXTERN (nexus)
+
+static int
+config(uint32_t width, uint32_t height, uint32_t d_width, uint32_t d_height, uint32_t flags, char *title, uint32_t format)
+{
+    return 0;
+}
+
+static uint32_t draw_image(mp_image_t* mpi)
+{
+    if (nexusmplayer_blit(mpi->w, mpi->h, mpi->planes[0]))
+	    return VO_TRUE;
+    else
+	    return 1;
+}
+
+static void draw_osd(void){}
+
+static void flip_page (void){}
+
+static int draw_frame(uint8_t * src[])
+{
+    return -1;
+}
+
+static int draw_slice( uint8_t *src[],int stride[],int w,int h,int x,int y )
+{
+    return -1;
+}
+
+static int
+query_format(uint32_t format)
+{
+    switch(format){
+    case IMGFMT_RGB|24:
+    case IMGFMT_BGR|24:
+        return VFCAP_CSP_SUPPORTED|VFCAP_CSP_SUPPORTED_BY_HW|VFCAP_ACCEPT_STRIDE;
+    }
+
+    return 0;
+}
+
+static void uninit(void){}
+
+static void check_events(void){}
+
+static int preinit(const char *arg)
+{
+    return 0;
+}
+
+static int control(uint32_t request, void *data, ...)
+{
+  switch (request) {
+  case VOCTRL_DRAW_IMAGE:
+    return draw_image(data);
+  case VOCTRL_QUERY_FORMAT:
+    return query_format(*((uint32_t*)data));
+  }
+  return VO_NOTIMPL;
+}
+
diff -Nur MPlayer-1.0rc2-orig/Makefile MPlayer-1.0rc2/Makefile
--- MPlayer-1.0rc2-orig/Makefile	2010-07-21 16:09:02.577710219 -0400
+++ MPlayer-1.0rc2/Makefile	2010-07-21 16:09:22.353709910 -0400
@@ -6,8 +6,22 @@
 
 include config.mak
 
-COMMON_LDFLAGS += $(EXTRA_LIB)\
-                  $(EXTRALIBS) \
+COMMON_LDFLAGS += -e compatmain \
+		  -static -nostdlib \
+		  -Wl,--start-group \
+		  ../../../lib/libnexus.a \
+		  ../../../lib/liblwip.a \
+		  ../../../lib/libnexus-sec.a \
+		  ../../../lib/libnexus-sys.a \
+		  ../../../lib/libcrypto.a \
+		  ../../../lib/libz.a \
+		  ../../../lib/libm.a \
+		  ../../../lib/libc.a \
+		  ../../../lib/crti.o \
+		  ../../../lib/crt1.o \
+		  ../../../lib/crtn.o \
+		  $(GCC_HOME)/libgcc.a \
+		  -Wl,--end-group 
 
 LDFLAGS_MPLAYER = $(EXTRALIBS_MPLAYER) \
                   $(COMMON_LDFLAGS) \
@@ -43,6 +57,7 @@
                parser-mpcmd.c \
                subopt-helper.c \
                command.c \
+	       nexus.c 
 
 SRCS_MENCODER = mencoder.c \
                 mp_msg-mencoder.c \
@@ -137,7 +152,7 @@
 
 include mpcommon.mak
 
-CFLAGS := $(subst -I..,-I.,$(CFLAGS))
+CFLAGS 	:= $(subst -I..,-I.,$(CFLAGS)) 
 
 libaf/libaf.a:
 	$(MAKE) -C libaf
diff -Nur MPlayer-1.0rc2-orig/mplayer.c MPlayer-1.0rc2/mplayer.c
--- MPlayer-1.0rc2-orig/mplayer.c	2010-07-21 16:09:02.453708957 -0400
+++ MPlayer-1.0rc2/mplayer.c	2010-07-21 16:09:13.830709493 -0400
@@ -6,6 +6,8 @@
 #include <stdlib.h>
 #include "config.h"
 
+#include "nexus.h"
+
 #ifdef WIN32
 #define _UWIN 1  /*disable Non-underscored versions of non-ANSI functions as otherwise int eof would conflict with eof()*/
 #include <windows.h>
@@ -1115,6 +1117,9 @@
 #endif
   line = malloc(width + 1); // one additional char for the terminating null
   
+// disabled. TODO: see if this is really necessary
+#ifndef ENABLE_DISABLED_FOR_NEXUS
+
   // Audio time
   if (mpctx->sh_audio) {
     saddf(line, &pos, width, "A:%6.1f ", a_pos);
@@ -1159,6 +1164,8 @@
       saddf(line, &pos, width, "??,?%% ");
   }
 
+#endif /* ENABLE_DISABLED_FOR_NEXUS */
+
   // VO stats
   if (sh_video) 
     saddf(line, &pos, width, "%d %d ", drop_frame_cnt, output_quality);
@@ -2279,6 +2286,7 @@
 
 int main(int argc,char* argv[]){
 
+nexusmplayer_init();
 
 char * mem_ptr;
 
@@ -2517,6 +2525,9 @@
 
 //------ load global data first ------
 
+
+// NEXUS: XXX check if this is still needed
+#if 0 
 // check font
 #ifdef HAVE_FREETYPE
   init_freetype();
@@ -2547,6 +2558,7 @@
 #endif
 
   vo_init_osd();
+#endif
 
 #ifdef USE_ASS
   ass_library = ass_init();
@@ -3590,6 +3602,8 @@
 
 mp_msg(MSGT_CPLAYER,MSGL_INFO,"\n");
 
+/// NEXUS. XXX probably no longer needed
+#if 0
 if(benchmark){
   double tot=video_time_usage+vout_time_usage+audio_time_usage;
   double total_time_usage;
@@ -3615,6 +3629,7 @@
 	(total_time_usage>0.5)?(total_frame_cnt/total_time_usage):0);
   
 }
+#endif
 
 // time to uninit all, except global stuff:
 uninit_player(INITED_ALL-(INITED_GUI+INITED_INPUT+(fixed_vo?INITED_VO:0)));
diff -Nur MPlayer-1.0rc2-orig/nexus.c MPlayer-1.0rc2/nexus.c
--- MPlayer-1.0rc2-orig/nexus.c	1969-12-31 19:00:00.000000000 -0500
+++ MPlayer-1.0rc2/nexus.c	2010-07-21 16:09:13.830709493 -0400
@@ -0,0 +1,37 @@
+/* Mplayer on Nexus compatibility file
+ *
+ */
+
+#ifdef __NEXUS__
+
+#include <stdlib.h>
+#include <stdio.h>
+
+#include <nexus/Console.interface.h>
+#include <nexus/init.h>
+#include "nexus.h"
+
+#endif
+
+void 
+nexusmplayer_init(void)
+{
+#ifdef __NEXUS__
+	// don't wait for [enter]. mplayer listens for individual keypresses
+	Console_SetInputMode(KBD_RARE);
+#endif
+}
+
+/// Call nexusblit if compiled for Nexus, noop otherwise.
+/// @return 1 if passed on to Nexus, 0 if not.
+int nexusmplayer_blit(unsigned int width, unsigned int height, 
+		      unsigned char *data)
+{
+#ifdef __NEXUS__
+	Console_Blit_Frame(data, width, height);
+	return 1;
+#else
+	return 0;
+#endif
+}
+
diff -Nur MPlayer-1.0rc2-orig/nexus.h MPlayer-1.0rc2/nexus.h
--- MPlayer-1.0rc2-orig/nexus.h	1969-12-31 19:00:00.000000000 -0500
+++ MPlayer-1.0rc2/nexus.h	2010-07-21 16:09:13.830709493 -0400
@@ -0,0 +1,11 @@
+/* Mplayer on Nexus compatibility file */
+
+#ifndef NEXUS_MPLAYER_H
+#define NEXUS_MPLAYER_H
+
+void nexusmplayer_init(void);
+int nexusmplayer_blit(unsigned int width, unsigned int height, 
+		      unsigned char *data);
+
+#endif /* NEXUS_MPLAYER_H */
+
diff -Nur MPlayer-1.0rc2-orig/README.nexus MPlayer-1.0rc2/README.nexus
--- MPlayer-1.0rc2-orig/README.nexus	1969-12-31 19:00:00.000000000 -0500
+++ MPlayer-1.0rc2/README.nexus	2010-07-21 16:09:13.830709493 -0400
@@ -0,0 +1,13 @@
+Mplayer on Nexus
+
+-- Implementation -----
+
+This nexus patch adds its own video output 'nexus' that blits
+frames to the framebuffer. For audio, it relies on common OSS
+through /dev/audio.
+
+-- Installation ----
+
+execute ./configure.nexus (NOT plain ./configure!)
+	make
+
diff -Nur MPlayer-1.0rc2-orig/stream/stream.c MPlayer-1.0rc2/stream/stream.c
--- MPlayer-1.0rc2-orig/stream/stream.c	2010-07-21 16:09:02.721711538 -0400
+++ MPlayer-1.0rc2/stream/stream.c	2010-07-21 16:09:13.830709493 -0400
@@ -154,6 +154,9 @@
   if(desc) {
     arg = m_struct_alloc(desc);
     if(sinfo->opts_url) {
+// in nexus. mplayer dies in its second invocation on the FP assignment to min here.
+// XXX find out cause, fix and remove this
+printf("%s:%d DEBUG: don't forget this bug\n", __FUNCTION__, __LINE__);
       m_option_t url_opt = 
 	{ "stream url", arg , CONF_TYPE_CUSTOM_URL, 0, 0 ,0, sinfo->opts };
       if(m_option_parse(&url_opt,"stream url",filename,arg,M_CONFIG_FILE) < 0) {
diff -Nur MPlayer-1.0rc2-orig/TOOLS/avisubdump.c MPlayer-1.0rc2/TOOLS/avisubdump.c
--- MPlayer-1.0rc2-orig/TOOLS/avisubdump.c	2010-07-21 16:09:02.509709105 -0400
+++ MPlayer-1.0rc2/TOOLS/avisubdump.c	2010-07-21 16:09:13.830709493 -0400
@@ -7,8 +7,8 @@
  * The subtitles are dumped to stdout.
  */
 
-#define _LARGEFILE_SOURCE
-#define _FILE_OFFSET_BITS 64
+//#define _LARGEFILE_SOURCE
+//#define _FILE_OFFSET_BITS 64
 #include <unistd.h>
 #include <stdio.h>
 #include <stdlib.h>
